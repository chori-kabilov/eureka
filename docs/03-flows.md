# 03 — Business Flows (MVP)

Документ описывает ключевые бизнес-сценарии CRM EUREKA.
Каждый сценарий — это последовательность действий пользователя и ожидаемый результат.

Если поведение не описано здесь, оно считается вне MVP.

---

## 1. Создание курса

**Актор:** Администратор

### Шаги:
1. Администратор открывает раздел «Курсы».
2. Нажимает «Создать курс».
3. Заполняет:
   - название
   - описание
   - тип оплаты студента
   - правило пропусков
   - тип оплаты преподавателя
4. Сохраняет курс.

### Результат:
- курс появляется в списке активных;
- курс доступен для создания групп;
- курс не содержит студентов и уроков.

---

## 2. Создание группы

**Актор:** Администратор

### Шаги:
1. Администратор открывает раздел «Группы».
2. Нажимает «Создать группу».
3. Выбирает:
   - курс
   - преподавателя
4. Задаёт:
   - название группы
   - дату начала
   - плановую дату окончания
   - дни недели и время занятий
   - лимит студентов
5. Сохраняет группу.

### Результат:
- группа создаётся в статусе `active`;
- группа готова к записи студентов;
- уроки ещё не созданы.

---

## 3. Запись студента в группу

**Актор:** Администратор

### Шаги:
1. Администратор открывает карточку студента.
2. Нажимает «Записать в группу».
3. Выбирает группу.
4. Подтверждает действие.

### Правила:
- если курс группы запрещает параллельное обучение — проверка выполняется до записи;
- превышение лимита группы запрещено.

### Результат:
- студент добавлен в группу;
- студент появляется в списке группы;
- участие начинается с ближайшего урока.

---

## 4. Формирование уроков

**Актор:** Система

### Шаги:
1. Система анализирует расписание группы.
2. Создаёт уроки:
   - по дням недели
   - в заданное время
   - начиная с даты начала группы.

### Правила:
- уроки создаются только для активных групп;
- закрытая группа не генерирует новые уроки;
- созданные уроки имеют статус `planned`.

### Результат:
- уроки появляются в календаре.

---

## 5. Перенос или отмена урока

**Актор:** Администратор

### Шаги:
1. Администратор открывает календарь.
2. Выбирает урок.
3. Выполняет одно из действий:
   - переносит дату/время
   - отменяет урок

### Правила:
- отменённый урок не имеет посещаемости;
- отменённый урок не учитывается в отчётах.

### Результат:
- урок обновлён или помечен как `cancelled`.

---

## 6. Проведение урока и отметка посещаемости

**Актор:** Преподаватель

### Шаги:
1. Преподаватель открывает своё расписание.
2. Выбирает текущий урок.
3. Отмечает каждого студента:
   - присутствовал
   - отсутствовал
4. Завершает урок.

### Правила:
- посещаемость возможна только для урока со статусом `planned`;
- завершённый урок получает статус `completed`;
- редактирование посещаемости после завершения запрещено (MVP).

### Результат:
- посещаемость сохранена;
- урок считается проведённым.

---

## 7. Замена преподавателя

**Актор:** Администратор

### Шаги:
1. Администратор открывает конкретный урок.
2. Назначает другого преподавателя.
3. Подтверждает замену.

### Правила:
- замена применяется только к одному уроку;
- замена не меняет преподавателя группы;
- оплата будет начислена заменяющему преподавателю.

### Результат:
- урок проведён заменяющим преподавателем;
- информация зафиксирована.

---

## 8. Фиксация оплаты

**Актор:** Администратор

### Шаги:
1. Администратор открывает раздел «Платежи».
2. Нажимает «Добавить платёж».
3. Указывает:
   - плательщика (студент / родитель)
   - сумму
   - дату
   - комментарий (опционально)
4. Сохраняет платёж.

### Правила:
- платёж всегда финальный;
- платёж не имеет статусов;

### Результат:
- платёж появляется в истории;
- учитывается в отчётах.

---

## 9. Просмотр информации студентом

**Актор:** Студент

### Шаги:
1. Студент входит в систему.
2. Открывает:
   - своё расписание
   - посещаемость

### Ограничения:
- студент не видит финансовые данные;
- студент не может изменять данные обучения.

---

## 10. Просмотр информации родителем

**Актор:** Родитель

### Шаги:
1. Родитель входит в систему.
2. Выбирает ребёнка.
3. Просматривает:
   - расписание
   - посещаемость

### Ограничения:
- только просмотр;
- оплаты в MVP фиксируются администратором.

---

## 11. Закрытие группы

**Актор:** Администратор

### Шаги:
1. Администратор открывает карточку группы.
2. Меняет статус на `completed`.

### Результат:
- новые уроки не создаются;
- история группы остаётся доступной;
- данные используются в отчётах.

---

## 12. Критические сценарии (must work)

Следующие сценарии обязаны работать без сбоев:
1. создание группы и расписания;
2. формирование уроков;
3. отметка посещаемости;
4. замена преподавателя;
5. фиксация оплаты;
6. просмотр данных пользователями.

---